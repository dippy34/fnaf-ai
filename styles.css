* { margin:0; padding:0; box-sizing:border-box; }
html, body { width:100%; height:100%; overflow:hidden; }
body {
  font-family: 'Courier New', 'Lucida Console', monospace;
  background:#000; color:#ccc;
  user-select:none; -webkit-user-select:none;
}
#game-container { width:100vw; height:100vh; position:relative; }
.hidden { display:none !important; }
canvas { display:block; }

/* ============ MENU ============ */
#menu-screen {
  position:absolute; inset:0; z-index:10;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  background: radial-gradient(ellipse at 50% 30%, #1a0808 0%, #050202 70%, #000 100%);
}
#menu-screen h1 {
  font-size: clamp(2.2rem,7vw,5rem);
  text-align:center; line-height:1.1;
  color:#ddd; letter-spacing:0.15em;
  text-shadow: 0 0 30px rgba(180,0,0,0.4), 0 2px 4px rgba(0,0,0,0.8);
}
#menu-screen h1 span { color:#8b0000; }
.subtitle { color:#555; font-size:1rem; margin:1rem 0 2rem; }
#night-select { margin-bottom:1.5rem; display:flex; align-items:center; gap:10px; }
#night-select label { color:#777; font-size:1.1rem; }
#night-choice {
  background:#111; color:#ccc; border:1px solid #444;
  padding:6px 16px; font-family:inherit; font-size:1.1rem; cursor:pointer;
}
#start-btn, #continue-btn {
  background:transparent; color:#ccc; border:2px solid #8b0000;
  padding:14px 50px; font-size:1.3rem; font-family:inherit;
  cursor:pointer; letter-spacing:0.1em; transition:all 0.25s;
}
#start-btn:hover, #continue-btn:hover {
  background:#8b0000; color:#fff; box-shadow:0 0 30px rgba(139,0,0,0.5);
}

/* ============ OFFICE ============ */
#office-view {
  position:absolute; inset:0; z-index:2;
  display:flex; background:#080808;
}
#left-hall-area, #right-hall-area {
  flex:0 0 18%; position:relative;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
}
#left-hall-area { background:linear-gradient(90deg,#050505,#0a0a0a); }
#right-hall-area { background:linear-gradient(270deg,#050505,#0a0a0a); }

#left-hall-window, #right-hall-window {
  position:absolute; top:12%; width:65%; height:35%;
  background:#0a0a0a; border:3px solid #1a1a1a;
}
#left-hall-window { left:17%; }
#right-hall-window { right:17%; }
.hall-lit {
  background:radial-gradient(ellipse at center,#2a2218 0%,#0a0a0a 70%) !important;
  border-color:#2a2218 !important;
}

.door {
  position:absolute; top:0; width:100%; height:100%;
  background:repeating-linear-gradient(0deg,#1a1510 0px,#1a1510 30px,#15110d 30px,#15110d 32px);
  transition:opacity 0.2s; z-index:3; pointer-events:none; opacity:0;
}
.door.shut { opacity:1; }

.door-indicator {
  position:absolute; top:10px; width:14px; height:14px;
  border-radius:50%; background:#1a3a1a; border:2px solid #333;
  z-index:5; transition:background 0.2s;
}
#left-door-indicator { left:10px; }
#right-door-indicator { right:10px; }
.door-indicator.active { background:#8b2020; box-shadow:0 0 10px #c44; }

.door-controls {
  position:absolute; bottom:12px;
  display:flex; flex-direction:column; gap:6px;
  z-index:5; width:80%; max-width:120px;
}
.left-controls { left:10%; }
.right-controls { right:10%; }

.ctrl-btn {
  background:#141414; color:#777; border:2px solid #2a2a2a;
  padding:10px 8px; font-family:inherit; font-size:0.75rem;
  cursor:pointer; letter-spacing:0.08em; transition:all 0.15s;
  text-align:center; width:100%;
}
.ctrl-btn:hover { background:#1e1e1e; border-color:#444; color:#aaa; }
.ctrl-btn.on { background:#2a1010; border-color:#8b0000; color:#e55; }

#office-center {
  flex:1; position:relative;
  background:linear-gradient(180deg,#0a0a08 0%,#111110 50%,#0d0d0b 100%);
  display:flex; flex-direction:column; align-items:center; justify-content:flex-end;
  min-width:0;
}
#office-canvas { width:100%; height:100%; }

#office-label {
  position:absolute; top:12px; left:50%; transform:translateX(-50%);
  font-size:1.1rem; color:#555; letter-spacing:0.2em;
  text-shadow:0 0 8px rgba(0,0,0,0.8);
}

#cam-btn, #panel-btn {
  position:absolute; left:50%; transform:translateX(-50%);
  background:rgba(0,0,0,0.6); color:#777; border:2px solid #444;
  padding:10px 24px; font-family:inherit; font-size:0.85rem;
  cursor:pointer; letter-spacing:0.1em; transition:all 0.2s;
  white-space:nowrap;
}
#cam-btn { bottom:58px; }
#panel-btn { bottom:16px; }
#cam-btn:hover, #panel-btn:hover { border-color:#888; color:#ccc; background:rgba(20,20,20,0.8); }

/* ============ CAMERA VIEW ============ */
#camera-view {
  position:absolute; inset:0; z-index:8;
  background:#000; display:flex; flex-direction:column;
}
#cam-feed-area { flex:1; position:relative; overflow:hidden; background:#000; }
#cam-canvas { width:100%; height:100%; }
#cam-static-overlay {
  position:absolute; inset:0; pointer-events:none; opacity:0.08;
  background:repeating-linear-gradient(0deg,transparent 0px,transparent 2px,rgba(255,255,255,0.03) 2px,rgba(255,255,255,0.03) 4px);
  animation:static-flicker 0.15s steps(2) infinite;
}
@keyframes static-flicker { 0%{opacity:0.06;} 50%{opacity:0.1;} 100%{opacity:0.06;} }
#cam-label {
  position:absolute; top:15px; left:20px;
  font-size:1.3rem; color:#aaa; text-shadow:0 0 10px rgba(0,0,0,0.8);
  letter-spacing:0.1em;
}
#cam-recording {
  position:absolute; top:15px; right:20px;
  font-size:0.9rem; color:#c44; letter-spacing:0.1em;
  animation:rec-blink 1s ease-in-out infinite;
}
@keyframes rec-blink { 0%,100%{opacity:1;} 50%{opacity:0.2;} }
#cam-map-panel {
  position:absolute; bottom:15px; right:15px;
  background:rgba(0,0,0,0.8); border:1px solid #333;
  padding:10px; border-radius:4px;
}
#cam-map {
  display:grid;
  grid-template-areas:
    ".        stage    stage    backstage"
    "pirate   dining   dining   ehall"
    ".        whall    .        ehall"
    "supply   wcorner  .        ecorner";
  grid-template-columns:repeat(4,68px);
  grid-template-rows:repeat(4,38px);
  gap:3px;
}
.cam-btn-map {
  background:#0e0e0e; color:#555; border:1px solid #2a2a2a;
  font-family:inherit; font-size:0.65rem; cursor:pointer;
  line-height:1.2; transition:all 0.15s; padding:2px;
}
.cam-btn-map small { font-size:0.5rem; color:#444; }
.cam-btn-map:hover { background:#181818; border-color:#555; color:#999; }
.cam-btn-map.active { background:#1a0808; border-color:#8b0000; color:#c44; }
.cam-btn-map.active small { color:#944; }
#cam-close-btn {
  position:absolute; bottom:20px; left:50%; transform:translateX(-50%);
  background:rgba(0,0,0,0.6); color:#777; border:2px solid #444;
  padding:10px 30px; font-family:inherit; font-size:0.9rem;
  cursor:pointer; letter-spacing:0.1em; transition:all 0.2s; z-index:5;
}
#cam-close-btn:hover { border-color:#888; color:#ccc; }

/* ============ CONTROL PANEL ============ */
#control-panel {
  position:absolute; inset:0; z-index:9;
  background:rgba(0,0,0,0.92);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
}
#panel-content {
  width:90%; max-width:500px;
  background:#0a0a0a; border:2px solid #333;
  padding:24px; border-radius:6px;
}
#panel-title {
  text-align:center; font-size:1.1rem; color:#888;
  letter-spacing:0.15em; margin-bottom:20px;
  border-bottom:1px solid #222; padding-bottom:12px;
}
.system-row {
  display:grid; grid-template-columns:1fr auto auto;
  grid-template-rows:auto auto;
  gap:4px 12px;
  align-items:center;
  padding:12px 0;
  border-bottom:1px solid #1a1a1a;
}
.sys-name { font-size:0.85rem; color:#999; letter-spacing:0.1em; }
.sys-status {
  font-size:0.75rem; padding:3px 10px; border-radius:2px;
  letter-spacing:0.1em; text-align:center; min-width:80px;
}
.sys-status.ok { background:#0a1a0a; color:#4a4; border:1px solid #1a3a1a; }
.sys-status.error { background:#1a0a0a; color:#c44; border:1px solid #3a1a1a; animation:error-blink 0.8s ease-in-out infinite; }
.sys-status.rebooting { background:#1a1a0a; color:#aa4; border:1px solid #3a3a1a; }
@keyframes error-blink { 0%,100%{opacity:1;} 50%{opacity:0.5;} }
.sys-reboot-btn {
  background:#141414; color:#666; border:1px solid #333;
  padding:4px 12px; font-family:inherit; font-size:0.7rem;
  cursor:pointer; letter-spacing:0.05em; transition:all 0.15s;
}
.sys-reboot-btn:hover { background:#1e1e1e; color:#aaa; border-color:#555; }
.sys-reboot-btn:disabled { opacity:0.3; cursor:default; }
.sys-bar {
  grid-column:1/-1; height:4px; background:#111; border-radius:2px; overflow:hidden;
}
.sys-bar-fill { height:100%; width:100%; background:#2a5a2a; transition:width 0.3s; }
.sys-bar-fill.error { background:#5a2a2a; }
.sys-bar-fill.rebooting { background:#5a5a2a; }
#panel-warnings {
  margin-top:12px; font-size:0.75rem; color:#666; text-align:center; min-height:20px;
}
#panel-close-btn {
  margin-top:16px;
  background:transparent; color:#777; border:2px solid #444;
  padding:10px 30px; font-family:inherit; font-size:0.9rem;
  cursor:pointer; letter-spacing:0.1em; transition:all 0.2s;
}
#panel-close-btn:hover { border-color:#888; color:#ccc; }

/* ============ HUD ============ */
#hud { position:absolute; inset:0; z-index:6; pointer-events:none; }
#hud-topleft {
  position:absolute; top:10px; left:15px; pointer-events:auto;
}
#office-room-tag {
  font-size:0.9rem; color:#444; letter-spacing:0.2em;
}
#hud-topright {
  position:absolute; top:10px; right:15px; text-align:right; pointer-events:auto;
}
#time-display { font-size:1.5rem; color:#aaa; }
#night-label { font-size:0.75rem; color:#555; }
#hud-bottom {
  position:absolute; bottom:8px; left:50%; transform:translateX(-50%);
  text-align:center; pointer-events:auto;
}
#power-section {
  font-size:0.85rem; color:#888;
  display:flex; gap:4px; align-items:center; justify-content:center;
}
.hud-sep { color:#333; margin:0 4px; }
#power-pct { color:#4a8a4a; transition:color 0.5s; }
#power-pct.low { color:#c44; }
#usage-bars { letter-spacing:2px; color:#4a4; }
#system-alerts {
  font-size:0.7rem; color:#c44; margin-top:2px; min-height:14px;
  letter-spacing:0.05em;
}

/* ============ JUMPSCARE ============ */
#jumpscare {
  position:absolute; inset:0; z-index:100; background:#000;
  animation:scare-shake 0.08s linear infinite;
}
#jumpscare-canvas { width:100%; height:100%; }
@keyframes scare-shake {
  0%,100%{transform:translate(0,0);}
  25%{transform:translate(-8px,-6px);}
  50%{transform:translate(6px,8px);}
  75%{transform:translate(-6px,4px);}
}

/* ============ WIN ============ */
#win-screen {
  position:absolute; inset:0; z-index:50;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  background:rgba(0,0,0,0.92);
}
#win-screen h2 { font-size:5rem; color:#5a5; margin-bottom:0.5rem; letter-spacing:0.2em; }
.win-cheer { font-size:1.3rem; color:#888; margin-bottom:2rem; }
